<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>Jack&#39;s Programming Notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Jack&#39;s Programming Notes">
<meta property="og:url" content="http://jack-nie.github.io/page/6/index.html">
<meta property="og:site_name" content="Jack&#39;s Programming Notes">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jack&#39;s Programming Notes">
  
    <link rel="alternate" href="/atom.xml" title="Jack&#39;s Programming Notes" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Jack&#39;s Programming Notes</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Feel the world!</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://jack-nie.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-adapter-pattern" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/adapter-pattern/" class="article-date">
  <time datetime="2015-04-26T16:00:00.000Z" itemprop="datePublished">2015-04-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/design-pattern/">design-pattern</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/adapter-pattern/">【转载】适配器模式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>适配器模式可以用于对不同的接口进行包装以及提供统一的接口，或者是让某一个对象看起来像是另一个类型的对象。在静态类型的编程语言里，我们经常使用它去满足类型系统的特点，但是在类似Ruby这样的弱类型编程语言里，我们并不需要这么做。尽管如此，它对于我们来说还是有很多意义的。</p>
<p>将一个类的接口转换成客户希望的另外一个接口。Adapter模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。——Gang of Four</p>
<p>假如你现在要管理游戏的服务器，而这个游戏有三个服务器，以服已经开放一段时间，二服和三服刚刚开放，现在你需要设计一个接口，要求传入不同的参数就能够获取到对应服的人数，如果传入的参数不合法，则返回-1。</p>
<p>首先定义一个父类，功能是统计在线人数。<br>    Ruby Code:<br>    class PlayerCount</p>
<pre><code>    def server_name
        raise &quot;You should override this method in subclass.&quot;
    end

    def player_count
        raise &quot;You should override this method in subclass.&quot;
    end

end
</code></pre><p>接着定义三个子类，非别对应一服、二服、三服，代码如下。<br>    Ruby Code:<br>    class ServerOne &lt; PlayerCount</p>
<pre><code>    def server_name
        &quot;一服&quot;
    end

    def player_count
        Utility.online_player_count(1)
    end

end

class ServerTwo &lt; PlayerCount

    def server_name
        &quot;二服&quot;
    end

    def player_count
        Utility.online_player_count(2)
    end

end

class ServerThree &lt; PlayerCount

    def server_name
        &quot;三服&quot;
    end

    def player_count
        Utility.online_player_count(3)
    end

end
</code></pre><p>接着，定义一个XMLBuilder类，用来将不同服的数据封装成XML格式输出。<br>    Ruby Code:<br>    class XMLBuilder</p>
<pre><code>  def self.build_xml player
        builder = &quot;&quot;
        builder &lt;&lt; &quot;&lt;root&gt;&quot;
        builder &lt;&lt; &quot;&lt;server&gt;&quot; &lt;&lt; player.server_name &lt;&lt; &quot;&lt;/server&gt;&quot;
        builder &lt;&lt; &quot;&lt;player_count&gt;&quot; &lt;&lt; player.player_count.to_s &lt;&lt; &quot;&lt;/player_count&gt;&quot;
        builder &lt;&lt; &quot;&lt;/root&gt;&quot;
  end

end
</code></pre><p>通过如下方式来查询各个服的玩家的数量。<br>    Ruby Code:<br>    XMLBuilder.build_xml(ServerOne.new)<br>    XMLBuilder.build_xml(ServerTwo.new)<br>    XMLBuilder.build_xml(ServerThree.new)<br>这看起来很好，但是因为一服已经运行了一段时间，已经有了查询玩家在线数量的方法了，使用的是ServerFirst这个类。当时写Utility.online_player_count()这个方法主要是为了针对新开的二服和三服，就没把一服的查询功能再重复做一遍。这种情况下可以使用适配器模式，这个模式就是为了解决接口之间不兼容的问题而出现的。其实适配器模式的使用非常简单，核心思想就是只要能让两个互不兼容的接口能正常对接就行了。上面的代码中，XMLBuilder中使用PlayerCount来拼装XML，而ServerFirst并没有继承PlayerCount，这个时候就需要一个适配器类来为XMLBuilder和ServerFirst之间搭起一座桥梁，毫无疑问，ServerOne就将充当适配器类的角色。修改ServerOne的代码，如下所示：<br>    Ruby Code:<br>    class ServerOne &lt; PlayerCount</p>
<pre><code>    def initialize
        @serverFirst = ServerFirst.new
    end

    def server_name
        &quot;一服&quot;
    end

    def player_count
        @serverFirst.online_player_count
    end

end
</code></pre><p>需要值得注意的一点是，适配器模式不并是那种会让架构变得更合理的模式，更多的时候它只是充当救火队员的角色，帮助解决由于前期架构设计不合理导致的接口不匹配的问题。更好的做法是在设计的时候就尽量把以后可能出现的情况多考虑一些。</p>
<p>参考资料：</p>
<ul>
<li><a href="https://martin91.github.io/blog/2014/03/03/jie-du-rails-gua-pei-qi-mo-shi/" title="jie-du-rails-gua-pei-qi-mo-shi" target="_blank" rel="noopener">https://martin91.github.io/blog/2014/03/03/jie-du-rails-gua-pei-qi-mo-shi/</a></li>
<li><a href="http://blog.csdn.net/guolin_blog/article/details/9400153" title=" Ruby设计模式透析之 —— 适配器(Adapter)" target="_blank" rel="noopener">http://blog.csdn.net/guolin_blog/article/details/9400153</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jack-nie.github.io/adapter-pattern/" data-id="cjqvrwirq000eud6x9es1bpct" class="article-share-link">Share</a>
      
        <a href="http://jack-nie.github.io/adapter-pattern/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-observer-pattern" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/observer-pattern/" class="article-date">
  <time datetime="2015-04-25T16:00:00.000Z" itemprop="datePublished">2015-04-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/design-pattern/">design-pattern</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/observer-pattern/">观察者模式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>观察者模式（有时又被称为发布/订阅模式）是软件设计模式的一种。在此种模式中，一个目标对象管理所有相依于它的观察者对象，并且在它本身的状态改变时主动发出通知。这通常透过呼叫各观察者所提供的方法来实现。此种模式通常被用来实作事件处理系统。在Ruby标准库中，观察者模式得到了很好的支持，开箱即用，但是为了更好的说明解释观察者模式，我们首先看一个不利用Ruby的Observer机制的例子。</p>
<h3 id="Observable"><a href="#Observable" class="headerlink" title="Observable"></a>Observable</h3><p>首先为被观察对象创建一个<code>Observable</code>模块，该模块的职能是在其状态发生改变时通知一个或多个观察者。<br>    Ruby Code:<br>    module Observable</p>
<pre><code>  attr_accessor :state

  def attachObserver(o)
    @observers ||= []
    @observers &lt;&lt; o if !@observers.include?(o)
  end

  def removeObserver(o)
    @observers.delete(o)
  end

  def state=(s)
    @state = s
    @observers.each do |o|
      o.update(self) # more on update() later!
    end
  end

end
</code></pre><p>方法<code>attachObserver</code>和<code>removeObserver</code>用来管理观察者，我们不想拥有相同的观察者，所以只添加那些没有观察我们定义的主体的观察者对象。<br>    Ruby Code:<br>    def state=(s)<br>      @state = s<br>      @observers.each do |o|<br>        o.update(self) # more on update() later!<br>      end<br>    end<br>当被观察对象的状态发生了改变，就需要通知其观察了该对象的观察者。首先，我们覆写了有方法<code>attr_accssor</code>默认创建的修改器，在这个例子中是<code>state=</code>。在给state赋一个新的值后，调用所有观察者的<code>update</code>方法。</p>
<h3 id="Observer"><a href="#Observer" class="headerlink" title="Observer"></a>Observer</h3><p>下面是Observer模块的实现：<br>    Ruby Code:<br>    module Observer</p>
<pre><code>  def update(o)
    raise &apos;Implement this!&apos;
  end

end
</code></pre><p>在该模块中，将<code>update</code>的具体功能留给包含它的类来实现，通过这种方式，<code>Observer</code>模块的行为就像是一个需要被其包含者实现的抽象类。</p>
<h3 id="蚁群"><a href="#蚁群" class="headerlink" title="蚁群"></a>蚁群</h3><p>作为一个简单的例子，首先定义我们的主体，也就是被观察者–蚂蚁女王。<br>    Ruby Code:<br>    class QueenAnt<br>      include Observable<br>    end<br>接下来定义一个观察者：<br>    Ruby Code:<br>    class WorkerAnt<br>      include Observer</p>
<pre><code>  def update(o)
    p &quot;I am working hard. Queen has changed state to #{o.state}!&quot;
  end
end
</code></pre><p>类WorkerAnt定义了在蚂蚁女王的状态发生改变时的特殊行为。<br>    Ruby Code:<br>    queen = QueenAnt.new</p>
<pre><code>worker1 = WorkerAnt.new
worker2 = WorkerAnt.new
worker3 = WorkerAnt.new

queen.attachObserver(worker1)
queen.attachObserver(worker2)

queen.state = &apos;sleeping&apos;
# I am working hard. Queen has changed state to sleeping!&quot;
# I am working hard. Queen has changed state to sleeping!&quot;
</code></pre><p>当蚂蚁女王的状态发生了改变，实例<code>worker1</code>、<code>worker2</code>会收到通知，并针对性的做出响应，实例<code>worker3</code>并没有并加入观察者列中，所以它不会受到通知。</p>
<h3 id="Obserever机制"><a href="#Obserever机制" class="headerlink" title="Obserever机制"></a>Obserever机制</h3><p>通过Ruby的Observer机制来实现观察者模式是很便捷的，只需要将<code>observer</code>模块混入被观察者对象就可以。<br>    Ruby Code:</p>
<pre><code># require the observer lib file
require “observer”
class Notifier
end

class EmailNotifier &lt; Notifier
  def update(bank_account)
    if bank_account.balance &lt;= 10
      puts “Sending email to: ‘#{bank_account.owner}’ informing \n
            him with his account balance: #{bank_account.balance}$.”
      # send the email mechanism
    end
  end
end

class SMSNotifier &lt; Notifier
  def update(bank_account)
    if bank_account.balance &lt;= 0.5
      puts “Sending SMS to: ‘#{bank_account.owner}’ informing \n
           him with his account balance: #{bank_account.balance}$.”
      # send sms mechanism
    end
  end
end

class BankAccount
  # include the observable module
  include Observable
  attr_reader :owner,:balance
  def initialize(owner,amount)
    @owner,@balance = owner,amount
    # adding list of observes to the account
    add_observer EmailNotifier.new
    add_observer SMSNotifier.new
  end

  # withdraw operation
  def withdraw(amount)
    # do whatever you need
    @balance -=amount if (@balance - amount) &gt; 0
    # now here comes our logic
    # issue that the account has changed
    changed
    # notify the observers
    notify_observers self
  end
end
account = BankAccount.new “Jim Oslen”, 100
account.withdraw 99.5
#=&gt;Sending email to: ‘Jim Oslen’ informing him with
#his account balance: 0.5$.
#=&gt;Sending SMS to: ‘Jim Oslen’ informing him with his
#account balance: 0.5$.
</code></pre><p>利用Ruby的Observer机制我们要做下面的工作：</p>
<ul>
<li>引入<code>observer</code>库并将其包含在被观察者类中。</li>
<li>改变对象的状态并通知观察者。</li>
<li>让所有需要的观察者和被观察者关联。</li>
<li>每个观察者必须实现<code>update</code>方法。</li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>观察者模式和<a href="https://jack-nie.github.io/blog/pattern-to-pattern-template-method-and-strategy/">策略模式</a>之间有一些相似之处,二者都是用一个对象（观察者模式的被观察者对象和策略模式的上下文对象）调用另一个对象（观察者模式的观察者和策略模式的策略）。二者的区别在于目的和适用情形的不同，观察者模式通过观察主题的不同状态来做出响应，策略模式则依赖于具体的策略来实现。</p>
<p>参考资料：</p>
<ul>
<li><a href="http://blog.khd.me/ruby/observer-and-singleton-design-patterns-in-ruby/" title="OBSERVER AND SINGLETON DESIGN PATTERNS IN RUBY" target="_blank" rel="noopener">http://blog.khd.me/ruby/observer-and-singleton-design-patterns-in-ruby/</a></li>
<li><a href="http://www.runtime-era.com/2012/12/basic-observer-design-pattern-in-ruby.html" title="Quick Review: Basic Observer Design Pattern in Ruby" target="_blank" rel="noopener">http://www.runtime-era.com/2012/12/basic-observer-design-pattern-in-ruby.html</a></li>
<li><a href="http://reefpoints.dockyard.com/2013/08/20/design-patterns-observer-pattern.html" title="Design Patterns: The Observer Pattern" target="_blank" rel="noopener">http://reefpoints.dockyard.com/2013/08/20/design-patterns-observer-pattern.html</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jack-nie.github.io/observer-pattern/" data-id="cjqvrwirj000aud6xd8zdeidr" class="article-share-link">Share</a>
      
        <a href="http://jack-nie.github.io/observer-pattern/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-template-method-pattern" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/template-method-pattern/" class="article-date">
  <time datetime="2015-04-24T16:00:00.000Z" itemprop="datePublished">2015-04-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/design-pattern/">design-pattern</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/template-method-pattern/">模板方法模式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>作为一个软件工程师，拥有一些设计模式的知识总是会受欢迎的。如果你没有听过设计模式，他们基本上是开发者遇到的一些通用问题的可复用的解决方案。设计模式的列表很长，了解全部的设计模式是都非常困难的。好吧，困难或许不是一个很准确的词，但是要掌握全部的设计模式需要很多的实践。让我们来看看设计模式中最简单的一个——模板方法，并且用Ruby来实现它。</p>
<h3 id="模板方法模式"><a href="#模板方法模式" class="headerlink" title="模板方法模式"></a>模板方法模式</h3><p>模板方法模式定义了一个操作中算法的框架，而将一些步骤延迟到子类中。模板方法模式使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。模板方法是一种基于继承的代码复用技术，他是一种类行为模式。<br>模板方法模式是结构最简单的行为型设计模式，在其结构中只存在父类与子类之间的继承关系。通过使用模板方法模式，可以将一些复杂流程的实现步骤封装在一系列基本方法中，在抽象父类中提供一个称之为模板方法的方法来定义这些基本方法的执行次序，而通过其子类来覆盖某些步骤，从而使得相同的算法框架可以有不同的执行结果。模板方法模式提供了一个模板方法来定义算法框架，而某些具体步骤的实现可以在其子类中完成。</p>
<h3 id="简单既是美"><a href="#简单既是美" class="headerlink" title="简单既是美"></a>简单既是美</h3><p>模板方法的优美之处在于它的简单性，但是关于它的定义却很冗长，导致你昏昏欲睡。通过将一系列的过程封装进不同的方法中来实现其行为的可配置性，使得子类可以覆写这些方法。下面是一个简单的例子：<br>    Ruby Code:<br>    class MagicCutter<br>      def initialize vegetable<br>        @vegetable = vegetable<br>      end</p>
<pre><code>  def give_me_the_vegetable_cutted_off
    prepapre_the_blade
    cut_the_vegetable
  end

  def prepapre_the_blade
    raise &apos;Called abstract method: prepapre_the_blade&apos;
  end

  def cut_the_vegetable
    raise &apos;Called abstract method: cut_the_vegetable&apos;
  end

end
</code></pre><p>框架方法是<code>give_me_the_vegetable_cutted_off</code>，它调用了一些列的方法，可以在子类中覆写这些方法使其拥有不同的行为。子类仅仅定义了那些将要改变的行为，覆写定义在框架类中的方法，但是<code>give_me_the_vegetable_cutted_off</code>不会被改变。让我们来看一下子类是如何实现的：<br>    Ruby Code:<br>    require_relative ‘magic_cutter’</p>
<pre><code>class AubergineCutter &lt; MagicCutter

  def prepapre_the_blade
    puts &quot;Hey! that&apos;s a #{@vegetable}&quot;
    puts &quot;i need a very sharp knife&quot;
  end

  def cut_the_vegetable
    puts &quot;I slice the #{@vegetable}  in long thumbsized pieces, ready to be grilled&quot;
  end

end

class PotatoCutter &lt; MagicCutter

  def prepapre_the_blade
    puts &quot;Hey! that&apos;s a #{@vegetable}&quot;
    puts &quot;i take a professional potato cutter for my french fries&quot;
  end

  def cut_the_vegetable
    puts &quot;put the #{@vegetable} in the cutter an press it&quot;
  end

end
</code></pre><p>继承、方法覆写……这些看起来很熟悉，但是结果却令人满意。<br>    Ruby Code:<br>    au = AubergineCutter.new(“Aubergine”)<br>    po = PotatoCutter.new(“Potato”)<br>    au.give_me_the_vegetable_cutted_off<br>    po.give_me_the_vegetable_cutted_off</p>
<h3 id="钩子方法"><a href="#钩子方法" class="headerlink" title="钩子方法"></a>钩子方法</h3><p>通过观察上面的两个子类，可以发现<code>puts “Hey! that’s a #{@vegetable}”</code>被重复了两次，并且从来不会被改变。更进一步，可以发现<code>PotatoCutter</code>并没有定义对蔬菜进行剥皮的操作，这正是引入钩子方法的时刻。钩子方法允许在子类覆写框架的实现并且定义一些新的东西，或者继承其默认的实现。让我们通过一个例子来看一下如何实现钩子方法<code>truly_excitement</code>和<code>prepare_the_vegetable</code>。<br>    Ruby Code:<br>    class MagicCutter<br>      def initialize vegetable<br>        @vegetable = vegetable<br>      end</p>
<pre><code>  def give_me_the_vegetable_cutted_off
    truly_excitement
    prepapre_the_vegetable
    prepapre_the_blade
    cut_the_vegetable
  end

  def truly_excitement
    puts &quot;Hey! that&apos;s a #{@vegetable}&quot;
  end

  def prepapre_the_vegetable
  end

  def prepapre_the_blade
    raise &apos;Called abstract method: prepapre_the_blade&apos;
  end

  def cut_the_vegetable
    raise &apos;Called abstract method: cut_the_vegetable&apos;
  end

end

class PotatoCutter &lt; MagicCutter

  def prepapre_the_vegetable
    puts &quot;skin the potato&quot;
  end

  def prepapre_the_blade
    puts &quot;i take a professional potato cutter for my french fries&quot;
  end

  def cut_the_vegetable
    puts &quot;put the potato in the cutter an press it&quot;
  end

end

c = PotatoCutter.new(&quot;Potato&quot;)
c.give_me_the_vegetable_cutted_off

class AubergineCutter &lt; MagicCutter

  def prepapre_the_blade
    puts &quot;i need a very sharp knife&quot;
  end

  def cut_the_vegetable
    puts &quot;I slice the #{@vegetable}  in long thumbsized pieces, ready to be grilled&quot;
  end

end

c = AubergineCutter.new(&quot;Aubergine&quot;)
c.give_me_the_vegetable_cutted_off
</code></pre><p>这些钩子方法的默认实现通常是空的，他们的存在仅仅是为了告诉子类将要发生什么，但是不需要子类覆写不必要的方法。上面的例子中<code>prepare_vegetable</code>是一个空的方法，将留给子类来决定如何实现它。</p>
<h3 id="一些需要注意的地方"><a href="#一些需要注意的地方" class="headerlink" title="一些需要注意的地方"></a>一些需要注意的地方</h3><p>模板方法越简单越好。<br>要避免写一个充满了方法的模板类，但是没有子类覆写这些方法，这会提高维护成本。<br>要避免提供过少的钩子，在某些时候，这就迫使子类不得不覆写整个方法。</p>
<p>参考资料：</p>
<ul>
<li><a href="http://reefpoints.dockyard.com/ruby/2013/07/10/design-patterns-template-pattern.html" title="Design Patterns: The Template Method Pattern" target="_blank" rel="noopener">http://reefpoints.dockyard.com/ruby/2013/07/10/design-patterns-template-pattern.html</a></li>
<li><a href="http://edapx.com/2013/10/27/template-pattern/" title="#1 template pattern" target="_blank" rel="noopener">http://edapx.com/2013/10/27/template-pattern/</a></li>
<li><a href="http://tammersaleh.com/posts/the-template-pattern-is-underused/" title="The Template Pattern is underused" target="_blank" rel="noopener">http://tammersaleh.com/posts/the-template-pattern-is-underused/</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jack-nie.github.io/template-method-pattern/" data-id="cjqvrwirh0009ud6x4gi49rmz" class="article-share-link">Share</a>
      
        <a href="http://jack-nie.github.io/template-method-pattern/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-pattern-to-pattern-template-method-and-strategy" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/pattern-to-pattern-template-method-and-strategy/" class="article-date">
  <time datetime="2015-04-23T16:00:00.000Z" itemprop="datePublished">2015-04-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/design-pattern/">design-pattern</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/pattern-to-pattern-template-method-and-strategy/">【翻译】模板方法模式和策略模式的比较</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近我写了一片关于<a href="http://rubylogs.com/template-method-pattern-in-ruby/" target="_blank" rel="noopener">模板方法模式</a>以及怎样在Ruby中实现的文章。有读者在文章的评论中指出模板方法模式实际上是策略模式。在经过仔细的考虑该怎么回答这个问题在之后，我决定写一篇文章来比较这两个模式。</p>
<p>所以，在这里我将展示我对于设计模式的理解，让我们来看一下这两个模式之间的共同点以及二者之间的关键区别。</p>
<h3 id="模板方法模式"><a href="#模板方法模式" class="headerlink" title="模板方法模式"></a>模板方法模式</h3><p>关于这个模式需要记住的最重要的一点是：样板方法写在父类中，而特定的算法则在子类中实现(通常是覆盖)。也就是说，所有的子类都会共享父类的功能(继承)，但父类仅仅是一个框架类。另一方面来讲，子类只能复写特定于其领域的方法。</p>
<h3 id="策略模式"><a href="#策略模式" class="headerlink" title="策略模式"></a>策略模式</h3><p>策略模式的核心是将逻辑封装进对象中，使的在这些对象可以互换并将对象作为算法实现的一部分，也就是说算法的行为可以通过策略在运行时改变。</p>
<h3 id="实现策略模式"><a href="#实现策略模式" class="headerlink" title="实现策略模式"></a>实现策略模式</h3><p>让我们来通过下面的小例子看一下如何使用策略模式，首先创建一个简单的<code>Invoice</code>类：<br>    Ruby Code:<br>    class Invoice<br>      attr_accessor :formatter</p>
<pre><code>  def initialize amount, buyer, seller
    @amount = amount
    @buyer = buyer
    @seller = seller
    @formatter = JSONFormatter.new
  end

  def generate
    @formatter.format! @amount, @buyer, @seller
  end

end
</code></pre><p>就像你所看到的，发票包含数量，买家的名字，卖家的名字，在它的构造方法中，一个格式器被创建。格式器是一个拥有<code>format！</code>方法的类的实例，它将amount，buyer，seller作为参数。当该方法被调用，将会创建一个特定格式的<code>Invoice</code>对象。策略类的一个非常重要的方面是上下文类期望通过策略类来实现，在我们的例子中是<code>format！</code>方法。举例来讲，在Java它将通过接口来实现，它强迫实现类实现某些特定的方法。但是因为Ruby是一门动态语言，它没有接口之类的东西，这一点我们必须提前考虑到。</p>
<p>话虽这么说，还是让我们来看一看格式器类，它们都是非常简单的。<br>    Ruby Code:<br>    class JSONFormatter<br>      def format! amount, buyer_name, seller_name<br>        %Q{<br>          {<br>            “buyer” =&gt; “#{buyer_name}”,<br>            “seller” =&gt; “#{seller_name}”,<br>            “amount” =&gt; “#{amount}”<br>          }<br>        }<br>      end<br>    end<br>类<code>JSONFormatter</code>以JSON格式创建发票，说句题外话，我在这里用了百分比符号，通过这种形式使得代码拥有更好的可读性。<br>    Ruby Code:<br>    class XMLFormatter<br>      def format! amount, buyer_name, seller_name<br>        %Q{<br>         <invoice><br>           <buyer>#{buyer_name}</buyer><br>           <seller>#{seller_name}</seller><br>           <amount>#{amount}</amount><br>         </invoice><br>       }<br>      end<br>    end<br>类<code>XMLFormatter</code>以<code>XML</code>格式创建发票。<br>    Ruby Code:<br>    class YAMLFormatter<br>      def format! amount, buyer_name, seller_name</p>
<pre><code>    %Q{
      ---
      invoice:
        buyer: #{buyer_name}
        seller: #{seller_name}
        amount: #{amount}
    }
  end
end
</code></pre><p>写在最后但并非不重要，类<code>YAMLFormatter</code>以<code>YAML</code>格式创建发票。策略模式的优美指出存在于上下文对象（<code>Invoice</code>对象）和策略(格式器)中。如你所见，当我们首先创建一个<code>Invoice</code>对象时，我们能够创建一个<code>JSON</code>格式的发票，这非常的酷。更酷的是你可以在运行时改变<code>Invoice</code>对象的行为，也就是说如果你改变了格式器对象，那么<code>Invoice</code>对象的行为也将改变。更抽象的将，上下文对象会随着赋予的每个不同的策略改变。那么怎样将其应用到我们的代码中呢？<br>    Ruby Code:<br>    invoice = Invoice.new 100, “John”, “Jane”<br>    puts invoice.generate<br>我们第一次输出Invoice，采用JSONFormatter，当我们我们将得到一个JSON格式的发票。<br>    Ruby Code:<br>    {<br>      “buyer” =&gt; “John”,<br>      “cashier” =&gt; “Jane”,<br>      “amount” =&gt; “100”<br>    }<br>现在，如果我们对同一个<code>Invoice</code>对象采用不同的格式器……<br>    Ruby Code:<br>    invoice.formatter = XMLFormatter.new<br>    puts invoice.generate<br>我们将得到同样的发票，不过是<code>XML</code>格式的。<br>    Ruby Code:<br>    <invoice><br>      <buyer>John</buyer><br>      <cashier>Jane</cashier><br>      <amount>100</amount><br>    </invoice><br>如你所见，我们改变了格式器，<code>Invoice</code>对象的行为也改变了。</p>
<h3 id="策略模式和模板方法模式"><a href="#策略模式和模板方法模式" class="headerlink" title="策略模式和模板方法模式"></a>策略模式和模板方法模式</h3><p>那么这二者之间的共同点和关键的不同之处是什么呢？我们你们其中的一些人已经很清楚了，另外一些人可能会很困惑（就像我最初一样）。二者都是将领域特定算法封装进对象中。最关键的区别在于策略模式通过策略在运行时改变上下文对象的行为，模板方法模式通过使用一个算法的框架实现，并且通过在框架的子类中覆写方法来改变其行为。</p>
<p>原文：</p>
<ul>
<li><a href="http://rubylogs.com/pattern-to-pattern-template-method-and-strategy/" title="Pattern to pattern: Template Method &amp; Strategy" target="_blank" rel="noopener">http://rubylogs.com/pattern-to-pattern-template-method-and-strategy/</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jack-nie.github.io/pattern-to-pattern-template-method-and-strategy/" data-id="cjqvrwir70001ud6xrg8e8hn1" class="article-share-link">Share</a>
      
        <a href="http://jack-nie.github.io/pattern-to-pattern-template-method-and-strategy/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-array-is-one-of-the-workhorses-in-ruby" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/array-is-one-of-the-workhorses-in-ruby/" class="article-date">
  <time datetime="2015-04-22T16:00:00.000Z" itemprop="datePublished">2015-04-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Ruby/">Ruby</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/array-is-one-of-the-workhorses-in-ruby/">Ruby中的Array详解</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在这篇文章中，我将深入探讨<code>Arrays</code>。数组中有很多方法我们每天都用，但是也有一部分方法我们甚至不知道他们的存在。</p>
<h3 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h3><p>关于数组有一个非常无聊的定义，但是我们必须记住：数组的下标是从0开始的。一个负数下标表明从数组的最后开始计数–也就是说-1代表数组的最后一个数，-2代表倒数第2个数，以此类推。</p>
<p>那么问题来了,我们要怎样去创建一个数组呢？<br> Ruby code:<br>        array = Array.new<br>         =&gt; []</p>
<p>或者<br> Ruby code:<br>        array = []<br>         =&gt; []<br>数组可以包含各种类型的对象，整数、字符串、浮点数等-数组并不关心类型。<br> Ruby code:<br>        array = [1, 2, “Super Mario”, 2.4, “Batman”, 100]<br>         =&gt; [1, 2, “Super Mario”, 2.4, “Batman”, 100]<br>或者</p>
<p> Ruby code:<br>        Array.new(3)<br>         =&gt; [nil, nil, nil]<br>或者</p>
<p> Ruby code:<br>        Array.new(3, true)<br>         =&gt; [true, true, true]<br>就像我们所熟知的，Ruby是一个完全的面向对象的语言，所以arrays也表现为对象。</p>
<h3 id="探索的越深就越有趣"><a href="#探索的越深就越有趣" class="headerlink" title="探索的越深就越有趣"></a>探索的越深就越有趣</h3><p>让我们从用的最多的迭代方法<code>#each</code>开始。这是一个我们过去见到过很多次并且在将来也会遇到很多次的方法。<code>Array</code>和<code>Range</code>类都有<code>#each</code>方法，通常<code>#each</code>会遍历每一个对象，并将其作为参数传入到block中，返回值为原始的集合。<br> Ruby code:<br>        [1, 3, 4, 1, 2].each {|n| puts “#{n}! “}<br>        1!<br>        3!<br>        4!<br>        1!<br>        2!<br>         =&gt; [1, 3, 4, 1, 2]<br>还有一个情况是如果想知道数组元素的位置，可以用<code>#each_with_index</code>。<br> Ruby code:<br>        %w{Ruby is cool and provides us<br>        with another syntax arrays}.each_with_index {|item, index| puts “position</p>
<pre><code>#{index} for #{item}&quot;}
position 0 for Ruby
position 1 for is
position 2 for cool
position 3 for and
position 4 for provides
position 5 for us
position 6 for with
position 7 for another
position 8 for syntax
position 9 for for
position 10 for arrays
 =&gt; [&quot;Ruby&quot;, &quot;is&quot;, &quot;cool&quot;, &quot;and&quot;, &quot;provides&quot;,
     &quot;us&quot;, &quot;with&quot;, &quot;another&quot;, &quot;syntax&quot;, &quot;for&quot;,
     &quot;arrays&quot;]
</code></pre><p>假设我们要区分偶数与基数，解决这个问题有许多种方法，但是<code>#select</code>是相对比较简洁的方法。<br> Ruby code:<br>        %w{1 2 3 4 5 6 7 8 9 10 11 112 123 1432}.select { |num| num%2==0 }<br>         =&gt; []<br>但是结果并不是像我们预期的那样，为什么呢？答案是非常简单的，让我们先来看一看<code>%w{1 2 3 4 5 6 7 8 9 10 11 112 123 1432}</code>返回的是什么。<br> Ruby code:<br>        %w{1 2 3 4 5 6 7 8 9 10 11 112 123 1432}<br>         =&gt; [“1”, “2”, “3”, “4”, “5”, “6”, “7”, “8”, “9”, “10”, “11”, “112”, “123”, “1432”]<br>问题很明显，我们不能对字符串应用除法运算，实际上我们不能对字符串做任何数学运算。<br> Ruby code:<br>        %q =&gt; Single quoted string<br>        %Q or % =&gt; Double quoted string<br>        %w or %W =&gt; Array of tokens<br>        %r =&gt; Regular Expression<br>        %x =&gt; Shell Command<br>        %i =&gt; Array of Symbols<br>为了避免这种情况让我们回到<code>[...]</code>,这样就不会再次踩坑。<br> Ruby code:<br>        [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 112, 123, 1432].select { |num| num%2==0 }<br>         =&gt; [2, 4, 6, 8, 10, 112, 1432]</p>
<p><strong>没有数据操作我们将变成什么?</strong>举例来说，我们有很多用户，然后需要根据用户名来自动生成邮件地址，<code>#map</code>在这里将充当救世主的角色。<br> Ruby code:<br>        users = [“Dalton Brown”, “Ralph Braun”, “Keara Mueller”, “Suzanne Schuppe”, “Trisha Batz”]<br>        users.map { |user| user.downcase.tr(“ “, “_”) + “@your_site.com” }<br>得到的结果是：<br> Ruby code:<br>        =&gt; [“dalton_brown@your_site.com”,  “ralph_braun@your_site.com”,<br>          “keara_mueller@your_site.com”, “suzanne_schuppe@your_site.com”,<br>          “trisha_batz@your_site.com”]</p>
<h3 id="鲜为人知的方法"><a href="#鲜为人知的方法" class="headerlink" title="鲜为人知的方法"></a>鲜为人知的方法</h3><p>请记住<code>#uniq</code>和<code>#uniq</code>这两个方法之间的区别。<code>#uniq</code>返回一个去掉了重复元素的新数组，但是<code>#uniq！</code>会直接从原数组中删除重复的元素。<br> Ruby code:<br>        example_array = [“x”, “z”, “z”, “z”, “a”, “b”, “b”]<br>        &gt; example_array.uniq<br>         =&gt; [“x”, “z”, “a”, “b”]<br>        &gt; example_array<br>         =&gt; [“x”, “z”, “z”, “z”, “a”, “b”, “b”]<br>和<br>  Ruby code:<br>        &gt; example_array.uniq!<br>         =&gt; [“x”, “z”, “a”, “b”]<br>        &gt; example_array<br>         =&gt; [“x”, “z”, “a”, “b”]<br>你想要对数组中的元素进行分组么？那么<code>#group将</code>很适合你。<br>  Ruby code:<br>        users.group_by{|name| name.length}<br>         =&gt; {12=&gt;[“Dalton Brown”], 11=&gt;[“Ralph Braun”, “Trisha Batz”], 13=&gt;[“Keara Mueller”], 15=&gt;[“Suzanne Schuppe”]}<br>还有其它的一些非常有用的方法如<code>|</code>和 <code>&amp;</code>。<br> Ruby code:<br>        milan_colors = %w{red black}<br>        liverpool_colors = %w{white red}<br>        milan_colors | liverpool_colors<br>        =&gt; [“red”, “black”, “white”]<br>        milan_colors &amp; liverpool_colors<br>        =&gt; [“red”]<br>当然还不能忘了范围方法，我是这么称呼的~~<br> Ruby code:<br>        2.1.2 :001 &gt; a = [1, 2, 3, 4, 5]<br>        =&gt; [1, 2, 3, 4, 5]<br>        2.1.2 :002 &gt; a[0..-3]<br>        =&gt; [1, 2, 3]<br>        2.1.2 :003 &gt; a[0…-3]<br>        =&gt; [1, 2]<br>&lt;&lt;, +, 操作符和concat<br> Ruby code:<br>        [1] &lt;&lt; [2,3]<br>        [1].concat([2,3])<br>        [1] + [2,3]</p>
<pre><code>#=&gt; [1, [2, 3]]
#=&gt; [1, 2, 3]
#=&gt; [1, 2, 3]
</code></pre><p>参考资料：</p>
<ul>
<li><a href="http://blog.diatomenterprises.com/arrays-are-the-workhorse-of-ruby/" target="_blank" rel="noopener">http://blog.diatomenterprises.com/arrays-are-the-workhorse-of-ruby/</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jack-nie.github.io/array-is-one-of-the-workhorses-in-ruby/" data-id="cjqvrwirg0006ud6xbrwdsle8" class="article-share-link">Share</a>
      
        <a href="http://jack-nie.github.io/array-is-one-of-the-workhorses-in-ruby/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-the-difference-between-instance_eval-and-instance_exec" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/the-difference-between-instance_eval-and-instance_exec/" class="article-date">
  <time datetime="2015-04-21T16:00:00.000Z" itemprop="datePublished">2015-04-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Ruby/">Ruby</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/the-difference-between-instance_eval-and-instance_exec/">【翻译】instance_eval和instance_exec之间的区别</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><code>#instance_eval</code>和<code>#instance_exec</code>之间有一个非常重要的区别。<a href="https://github.com/thoughtbot/factory_girl" target="_blank" rel="noopener">Factory Girl</a>是一个展示如何优雅的使用以上两者的很好的例子。</p>
<p>但是首先，在你急不可耐的准备构建令人惊奇的DSL之前，让我们来看一下<code>#instance_eval</code>是什么以及有什么作用。</p>
<p>最简单的例子来自于Ruby Docs:<br>        Ruby Code:<br>        class KlassWithSecret<br>          def initialize<br>            @secret = 99<br>          end<br>        end<br>        k = KlassWithSecret.new<br>        k.instance_eval { @secret } #=&gt; 99</p>
<p>在提供的block中的<code>self</code>的当前值是调用<code>#instance_eval</code>的那个对象。所以，假设对象<code>k</code>是block的当前上下文；<code>@secret</code>是存储在<code>k</code>中的变量，<code>#instance_eval</code>打开了该对象的通道并且能够获取其所有的内部变量。</p>
<p>FactoryGirl提供的接口简单而直接，下面是一个来自于其”Getting Started”文档的例子。<br>        Ruby Code:<br>        FactoryGirl.define do<br>          factory :user do<br>            first_name “Kristoff”<br>            last_name  “Bjorgman”<br>            admin false<br>          end<br>        end<br>在这里，Factory Girl使用<code>#instance_eval</code>来执行传递给<code>factory</code>的代码块。让我们通过一些富有表现力的代码来看一下FactoryGirl是怎么让这些工作起来的。<br>        Ruby Code:<br>        def factory(name, &amp;block)<br>          factory = Factory.new(name)<br>          factory.instance_eval(&amp;block) if block_given?</p>
<pre><code>  # ... more code
end
</code></pre><p>实际上，这并不是来自于Factory Girl的代码， 但是它大致的说明了发生了什么。当<code>#factory</code>被调用时，一个新的<code>Factory</code>对象就被创建了，然后代码块就在该对象的上下文中执行。换句话讲，当你看到<code>first_name</code>时，就像看到该factory对象在前面，而不是<code>factory.first_name</code>。通过使用<code>#instance_eval</code>，Factory Girl的使用者不需要指定factory对象，它被隐式的添加。</p>
<p>好了，这一切都很好，但对于<code>#instance_exec</code>呢？我很高兴你问到了。</p>
<p>方法<code>#instance_eval</code>仅能评估(? evaluate~~怎么翻译好呢)代码块或者字符串，仅此而已。想要传递参数给代码块？你会遇到很大的麻烦。</p>
<p>但是<code>#instance_exec</code>不仅能够评估提供的代码块，还允许传递参数。让我们来看一个例子。</p>
<p>FactoryGirl允许通过使用回掉函数来执行一些动作，比如在对象创建之后。<br>        Ruby Code:<br>        FactoryGirl.define do<br>          factory :user do<br>            first_name “Kristoff”<br>            last_name “Bjorgman”<br>            admin false</p>
<pre><code>    after(:create) do |user, evaluator|
      create_list(:post, evaluator.posts_count, user: user)
    end
  end
end
</code></pre><p>在这个例子中，<code>after(:create)</code>在对象创建之后执行，代码块接收了两个参数：<code>user</code>和<code>evaluator</code>。<code>user</code>参数是刚刚创建的user对象，<code>evaluator</code>参数存储了所有factory创建的所有的值。下面让我们来看一下这些是如何实现的。<br>        Ruby Code:<br>        def run(instance, evaluator)<br>          case block.arity<br>          when 1, -1 then syntax_runner.instance_exec(instance, &amp;block)<br>          when 2 then syntax_runner.instance_exec(instance, evaluator, &amp;block)<br>          else        syntax_runner.instance_exec(&amp;block)<br>          end<br>        end<br>FactoryGirl会创建一个以传递给after method的参数命名的callback。在该情形中，callback的名字是<code>：create</code>，同时还有一个代码块。</p>
<p>我们的例子中使用的代码块有两个参数。<code>run</code>方法决定怎样执行来自于代码块的代码。</p>
<p>callback对象存储了代码块，并且Ruby允许我们检查代码块的元数，换句话讲，它允许我们检查参数的数量。</p>
<p>当看<code>case</code>语句时，先检查<code>else</code>是一个好的主意，这会让你知道在没有匹配到任何代码的时候，<code>when</code>的部分会发生什么。接下来我们来看<code>syntax_runner.instance_exec(&amp;block)</code>,这可以很容易的被<code>instance_eval</code>代替。Ruby会在<code>syntax_runner</code>对象的上下文中评估或者执行代码块。</p>
<p>如果代码块的元数大于0，FactoryGirl会为对象提供一个代码块以便让这段代码符合我们的预期。case的第二部分检查代码块的元数是否等于2。<br>    Ruby Code:<br>    when 2 then syntax_runner.instance_exec(instance, evaluator, &amp;block)<br>如果是，<code>syntax_runner</code>会接受一个实例对象(在我们的例子中是<code>user</code>)和<code>evaluator</code>。如果代码块的元数是1或者-1，代码块将仅接受一个<code>instance</code>参数。</p>
<p>那么-1代表什么呢？让我们来看一下怎么创建一个callback：<br>        Ruby Code:</p>
<pre><code># Two arguments and arity of 2
after(:create) do |user, evaluator|
  create_list(:post, evaluator.posts_count, user: user)
end
# One argument and arity of 1
after(:create) do |user|
  create_group(:people, user: user)
end
# Zero arguments and arity of 0
after(:create) do
  puts &quot;Yay!&quot;
end
# Any arguments and arity of -1
after(:create) do |*args|
  puts &quot;The user is #{args.first}&quot;
end
</code></pre><p>通过<code>*args</code>Ruby并不知道你究竟会传递几个参数，所以Ruby干脆撒手不管，直接传回一个奇怪的数字-1。</p>
<p>这就是理解怎样和合何时使用<code>instance_exec</code>的力量，DSL用户会期望这些会有作用，事实上，确实会。</p>
<p>但是等一等，还有更多！如果你想为不同的属性指定同样的值呢？<br>        Ruby Code:<br>        FactoryGirl.define do<br>          factory :user do<br>            first_name “Kristoff”<br>            last_name  “Bjorgman”</p>
<pre><code>    password &quot;12345&quot;
    password_confirmation &quot;12345&quot;
  end
end
</code></pre><p>在上面的例子中，<code>password</code>和<code>password_confirmation</code>拥有同样的值，这可能不怎么好。如果你改了其中的一个，而忘了了更改另外一个？当他们被绑定在实现中，二者的不一致可能会导致一些意想不到的错误。</p>
<p>我更愿意或许你也是，告诉FactoryGirl使用已经定义好的值。幸运的是，FiactoryGrl允许我们使用Ruby的一个小技巧<code>#to_proc</code>,下面展示了如何使用。<br>        Ruby Code:<br>        FactoryGirl.define do<br>          factory :user do<br>            first_name “Kristoff”<br>            last_name  “Bjorgman”</p>
<pre><code>    password &quot;12345&quot;
    password_confirmation &amp;:password
  end
end
</code></pre><p>重要的部分是传递给<code>password_conformation</code>的<code>&amp;：password</code>值，Ruby看到<code>&amp;</code>字符会将其视为代码块调用了<code>to_proc</code>方法。为了实现这个功能，FactoryGirl在属性上定义<code>to_proc</code>，并且使用<code>instance_exec</code>将符号<code>password</code>提供给代码块。<br>        Ruby Code:<br>        def to_proc<br>          block = @block</p>
<pre><code>  -&gt; {
    value = case block.arity
            when 1, -1 then instance_exec(self, &amp;block)
            else instance_exec(&amp;block)
            end
    raise SequenceAbuseError if FactoryGirl::Sequence === value
    value
  }
end
</code></pre><p>那么对于lambda和proc呢？一些评论者在Reddit上提出了一个很重要的问题：关于<code>#instance_eval</code>和<code>#instance_exec</code>在分别传递lambda和proc的时候是如何表现的。</p>
<p>如果你传递一个lambda并且不提供参数，<code>#instance_eval</code>会出错。<br>        Ruby Code:<br>        object = Object.new<br>        argless = -&gt;{ puts “foo” }<br>        object.instance_eval(&amp;argless) #=&gt; ArgumentError: wrong number of arguments (1 for 0)<br>之所以会出现这个错误，是因为Ruby会将当前对象作为<code>self</code>传递给block，解决方案是提供接受参数的lambda。<br>        Ruby Code:<br>        args = -&gt;(obj){ puts “foo” }<br>        object.instance_eval(&amp;args) #=&gt; “foo”<br>如果使用<code>#instance_exec</code>将会有点小变化。<br>        Ruby Code:<br>        object.instance_exec(&amp;argless) #=&gt; “foo”<br>        object.instance_exec(&amp;args) #=&gt; ArgumentError: wrong number of arguments (0 for 1)<br>        object.instance_exec(“some argument”, &amp;args) #=&gt; “foo”<br>因为<code>proc</code>在参数校验方面不是那么严格，所以以上两种尝试都不会导致错误。<br>        Ruby Code:<br>        p_argless = proc{ puts “foo” }<br>        object.instance_eval(&amp;p_argless) #=&gt; “foo”</p>
<pre><code>p_args = proc{|obj| puts &quot;foo&quot; }
object.instance_eval(&amp;p_args) #=&gt; &quot;foo&quot;

object.instance_exec(&amp;p_args) #=&gt; &quot;foo&quot;
object.instance_exec(&amp;p_argless) #=&gt; &quot;foo&quot;
</code></pre><p>现在你知道了<code>#instance_eval</code>和<code>#instance_exec</code>在表现方式上是类似的，如果你需要传递参数，那么请使用<code>#instance_exec</code>。</p>
<p>原文：</p>
<ul>
<li><a href="http://www.saturnflyer.com/blog/jim/2015/04/22/the-difference-between-instance_eval-and-instance_exec/" title="The Difference Between Instance_eval And Instance_exec" target="_blank" rel="noopener">http://www.saturnflyer.com/blog/jim/2015/04/22/the-difference-between-instance_eval-and-instance_exec/</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jack-nie.github.io/the-difference-between-instance_eval-and-instance_exec/" data-id="cjqvrwire0005ud6xasjoa7x6" class="article-share-link">Share</a>
      
        <a href="http://jack-nie.github.io/the-difference-between-instance_eval-and-instance_exec/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-centering-css-complete-guide" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/centering-css-complete-guide/" class="article-date">
  <time datetime="2015-03-13T16:00:00.000Z" itemprop="datePublished">2015-03-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CSS/">CSS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/centering-css-complete-guide/">【翻译】CSS居中完全指导手册</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>前端开发中，CSS居中一直是一个令人头痛的问题。为什么CSS居中这么困难呢？其实实现CSS居中并不难，难的是如何从众多的CSS居中方法中选择一个合适的解决方案，通常你并不知道那种解决方案适合当前的情形。所以，让我们来整理一个决策树，希望能够帮助大家更容易的解决CSS居中的问题。</p>
<h3 id="一-水平居中"><a href="#一-水平居中" class="headerlink" title="一.水平居中"></a>一.水平居中</h3><h3 id="1-是否是-inline或者inline-元素"><a href="#1-是否是-inline或者inline-元素" class="headerlink" title="#  1.是否是 inline或者inline-*元素"></a>#  1.是否是 inline或者inline-*元素</h3><p>  将inline元素放置在block父元素中，然后给父元素加上<code>text-align: center;</code></p>
<pre><code>HTML:
&lt;header&gt;
  This text is centered.
&lt;/header&gt;

&lt;nav role=&apos;navigation&apos;&gt;
  &lt;a href=&quot;#0&quot;&gt;One&lt;/a&gt;
  &lt;a href=&quot;#0&quot;&gt;Two&lt;/a&gt;
  &lt;a href=&quot;#0&quot;&gt;Three&lt;/a&gt;
  &lt;a href=&quot;#0&quot;&gt;Four&lt;/a&gt;
&lt;/nav&gt;
</code></pre><p>CSS:<br>    body {<br>      background: #f06d06;<br>    }</p>
<pre><code>header, nav {
  text-align: center;
  background: white;
  margin: 20px 0;
  padding: 10px;
}

nav a {
  text-decoration: none;
  background: #333;
  border-radius: 5px;
  color: white;
  padding: 3px 8px;
}
</code></pre><h3 id="2-是否是block元素"><a href="#2-是否是block元素" class="headerlink" title="#  2.是否是block元素"></a>#  2.是否是block元素</h3><p>  可以利用<code>margin:0 auto;</code>来实现水平居中，利用这种技术的前提是该元素拥有一个固定的宽度。<br>HTML:<br>     <main><br>      <div class="center"><br>     I’m a block level element and am centered.<br>      </div><br>     </main><br>CSS:<br>    body {<br>      background: #f06d06;<br>    }</p>
<pre><code>main {
  background: white;
  margin: 20px 0;
  padding: 10px;
}

.center {
  margin: 0 auto;
  width: 200px;
  background: black;
  padding: 20px;
  color: white;
}
</code></pre><h3 id="3-是否有多个block元素需要居中"><a href="#3-是否有多个block元素需要居中" class="headerlink" title="#  3.是否有多个block元素需要居中"></a>#  3.是否有多个block元素需要居中</h3><p>  如果你有多种block级别的元素需要在一行中水平居中，那么你最好赋予这些元素的display属性不同的值。</p>
<p>HTML:<br>    <main class="inline-block-center"><br>      <div><br>    I’m an element that is block-like with my siblings and we’re centered in a row.<br>      </div><br>      <div><br>    I’m an element that is block-like with my siblings and we’re centered in a row. I have more content in me than my siblings do.<br>      </div><br>      <div><br>    I’m an element that is block-like with my siblings and we’re centered in a row.<br>      </div><br>    </main><br>    <main class="flex-center"><br>      <div><br>    I’m an element that is block-like with my siblings and we’re centered in a row.<br>      </div><br>      <div><br>    I’m an element that is block-like with my siblings and we’re centered in a row. I have more content in me than my siblings do.<br>      </div><br>      <div><br>    I’m an element that is block-like with my siblings and we’re centered in a row.<br>      </div><br>    </main><br>CSS:<br>    body {<br>      background: #f06d06;<br>      font-size: 80%;<br>    }</p>
<pre><code>main {
  background: white;
  margin: 20px 0;
  padding: 10px;
}

main div {
  background: black;
  color: white;
  padding: 15px;
  max-width: 125px;
  margin: 5px;
}

.inline-block-center {
  text-align: center;
}
.inline-block-center div {
  display: inline-block;
  text-align: left;
}

.flex-center {
  display: flex;
  justify-content: center;
}
</code></pre><h3 id="二-垂直居中"><a href="#二-垂直居中" class="headerlink" title="二.垂直居中"></a>二.垂直居中</h3><p>相对而言，CSS垂直居中的实现更加的复杂一点。</p>
<h3 id="1-是否是inline或者inline-元素"><a href="#1-是否是inline或者inline-元素" class="headerlink" title="#1.是否是inline或者inline-*元素"></a>#1.是否是inline或者inline-*元素</h3><ul>
<li><p>需要居中的元素是否只有一行?<br>有时候赋予元素相等的上下内边距就可以实现元素的垂直居中。<br>HTML:</p>
<pre><code>&lt;main&gt;
  &lt;a href=&quot;#0&quot;&gt;We&apos;re&lt;/a&gt;
  &lt;a href=&quot;#0&quot;&gt;Centered&lt;/a&gt;
  &lt;a href=&quot;#0&quot;&gt;Bits of&lt;/a&gt;
  &lt;a href=&quot;#0&quot;&gt;Text&lt;/a&gt;
&lt;/main&gt;
</code></pre><p>CSS:</p>
<pre><code>body {
  background: #f06d06;
  font-size: 80%;
}

main {
  background: white;
  margin: 20px 0;
  padding: 50px;
}

main a {
  background: black;
  color: white;
  padding: 40px 30px;
  text-decoration: none;
}
</code></pre><p>如果padding的解决方案不能满足要求，并且需要居中的文字不会被包裹，那么可以设置line-height和height的值相等。</p>
</li>
</ul>
<p>HTML:<br>        <main><br>          <div><br>              I’m a centered line.<br>         </div><br>        </main><br>CSS:<br>        body {<br>          background: #f06d06;<br>          font-size: 80%;<br>        }</p>
<pre><code>main {
  background: white;
  margin: 20px 0;
  padding: 40px;
}

main div {
  background: black;
  color: white;
  height: 100px;
  line-height: 100px;
  padding: 20px;
  width: 50%;
  white-space: nowrap;
}
</code></pre><ul>
<li><p>需要居中的元素是否有多行？<br>设置相同的上下内边距同样可以让多行的inline元素居中，如果这种技术不能够实现居中，可以采用<code>display:table-cell;</code>来实现垂直居中。<br>HTML:</p>
<pre><code>&lt;table&gt;
  &lt;tr&gt;
    &lt;td&gt;
      I&apos;m vertically centered multiple lines of text in a real table cell.
   &lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

&lt;div class=&quot;center-table&quot;&gt;
  &lt;p&gt;I&apos;m vertically centered multiple lines of text in a CSS-created table layout.&lt;/p&gt;
&lt;/div&gt;
</code></pre><p>CSS:</p>
<pre><code>body {
  background: #f06d06;
  font-size: 80%;
}

table {
  background: white;
  width: 240px;
  border-collapse: separate;
  margin: 20px;
  height: 250px;
}

table td {
  background: black;
  color: white;
  padding: 20px;
  border: 10px solid white;
  /* default is vertical-align: middle; */
}

.center-table {
  display: table;
  height: 250px;
  background: white;
  width: 240px;
  margin: 20px;
}
.center-table p {
  display: table-cell;
  margin: 0;
  background: black;
  color: white;
  padding: 20px;
  border: 10px solid white;
  vertical-align: middle;
}
</code></pre><p>另外的一种实现垂直居中的方案是采用<code>display:flex;</code>这种方案相对来讲也比较简单。利用flex-box方案需要父容器有一个固定的高度。<br>HTML:</p>
<pre><code>&lt;div class=&quot;flex-center&quot;&gt;
  &lt;p&gt;I&apos;m vertically centered multiple lines of text in a flexbox container.&lt;/p&gt;
&lt;/div&gt;
</code></pre><p>CSS:</p>
<pre><code>body {
    background: #f06d06;
    font-size: 80%;
}

div {
    background: white;
    width: 240px;
    margin: 20px;
 }

.flex-center {
    background: black;
    color: white;
    border: 10px solid white;
    display: flex;
    flex-direction: column;
    justify-content: center;
    height: 200px;
    resize: vertical;
    overflow: auto;
}
.flex-center p {
    margin: 0;
    padding: 20px;
}
</code></pre><p>如果以上方案都不能满足要求，可以尝试采用”Goast Element”技术，该技术在容器中放置一个100%高度的伪元素来实现目标元素的居中。<br>HTML:</p>
<pre><code>&lt;div class=&quot;ghost-center&quot;&gt;
  &lt;p&gt;I&apos;m vertically centered multiple lines of text in a container. Centered with a ghost pseudo element&lt;/p&gt;
&lt;/div&gt;
</code></pre><p>CSS:</p>
<pre><code>body {
  background: #f06d06;
  font-size: 80%;
}

div {
  background: white;
  width: 240px;
  height: 200px;
  margin: 20px;
  color: white;
  resize: vertical;
  overflow: auto;
  padding: 20px;
}

.ghost-center {
  position: relative;
}
.ghost-center::before {
  content: &quot; &quot;;
  display: inline-block;
  height: 100%;
  width: 1%;
  vertical-align: middle;
}
.ghost-center p {
  display: inline-block;
  vertical-align: middle;
  width: 190px;
  margin: 0;
  padding: 20px;
  background: black;
}
</code></pre><h3 id="2-是否是block元素-1"><a href="#2-是否是block元素-1" class="headerlink" title="#2.是否是block元素"></a>#2.是否是block元素</h3></li>
</ul>
<ul>
<li>元素高度已知<br>大多数情况下我们并不知道需要居中的元素的高度，原因有很多，这里不赘述。倘若你知道元素的高度，那么可以利用如下的方法实现block元素的垂直居中。</li>
</ul>
<p>HTML:<br>        <main></main></p>
<pre><code>  &lt;div&gt;
     I&apos;m a block-level element with a fixed height, centered vertically within my parent.
  &lt;/div&gt;

&lt;/main&gt;
</code></pre><p>CSS:<br>        body {<br>          background: #f06d06;<br>          font-size: 80%;<br>        }</p>
<pre><code>main {
  background: white;
  height: 300px;
  margin: 20px;
  width: 300px;
  position: relative;
  resize: vertical;
  overflow: auto;
}

main div {
  position: absolute;
  top: 50%;
  left: 20px;
  right: 20px;
  height: 100px;
  margin-top: -70px;
  background: black;
  color: white;
  padding: 20px;
}
</code></pre><ul>
<li>元素的高度未知</li>
</ul>
<p>HTML:<br>        <main></main></p>
<pre><code>  &lt;div&gt;
     I&apos;m a block-level element with an unknown height, centered vertically within my parent.
  &lt;/div&gt;

&lt;/main&gt;
</code></pre><p>CSS:<br>        body {<br>          background: #f06d06;<br>          font-size: 80%;<br>        }</p>
<pre><code>main {
  background: white;
  height: 300px;
  margin: 20px;
  width: 300px;
  position: relative;
  resize: vertical;
  overflow: auto;
}

main div {
  position: absolute;
  top: 50%;
  left: 20px;
  right: 20px;
  background: black;
  color: white;
  padding: 20px;
  transform: translateY(-50%);
  resize: vertical;
  overflow: auto;
}
</code></pre><h3 id="3-是否可以使用flex-box"><a href="#3-是否可以使用flex-box" class="headerlink" title="# 3.是否可以使用flex-box"></a># 3.是否可以使用flex-box</h3><p>HTML:<br>        <main></main></p>
<pre><code>  &lt;div&gt;
     I&apos;m a block-level element with an unknown height, centered vertically within my parent.
  &lt;/div&gt;

&lt;/main&gt;
</code></pre><p>CSS:<br>        body {<br>          background: #f06d06;<br>          font-size: 80%;<br>        }</p>
<pre><code>main {
  background: white;
  height: 300px;
  width: 200px;
  padding: 20px;
  margin: 20px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  resize: vertical;
  overflow: auto;
}

main div {
  background: black;
  color: white;
  padding: 20px;
  resize: vertical;
  overflow: auto;
}
</code></pre><h3 id="三-水平居中和垂直居中"><a href="#三-水平居中和垂直居中" class="headerlink" title="三.水平居中和垂直居中"></a>三.水平居中和垂直居中</h3><p> 可以组合前文提到的方案来实现元素的水平和垂直居中，下面给出三种比较常见的组合。</p>
<h3 id="1-元素的宽度和高度固定"><a href="#1-元素的宽度和高度固定" class="headerlink" title="# 1.元素的宽度和高度固定"></a># 1.元素的宽度和高度固定</h3><p> 使用负边距来定位，左右负边距设置为宽度的一半，上下负边距设定为高度的一半，这种方案的兼容性很好。</p>
<p>HTML:<br>        <main></main></p>
<pre><code>  &lt;div&gt;
     I&apos;m a block-level element a fixed height and width, centered vertically within my parent.
  &lt;/div&gt;

&lt;/main&gt;
</code></pre><p>CSS:<br>        body {<br>          background: #f06d06;<br>          font-size: 80%;<br>          padding: 20px;<br>        }</p>
<pre><code>main {
  position: relative;
  background: white;
  height: 200px;
  width: 60%;
  margin: 0 auto;
  padding: 20px;
  resize: both;
  overflow: auto;
}

main div {
  background: black;
  color: white;
  width: 200px;
  height: 100px;
  margin: -70px 0 0 -120px;
  position: absolute;
  top: 50%;
  left: 50%;
  padding: 20px;
}
</code></pre><h3 id="2-元素的宽度和高度未知。"><a href="#2-元素的宽度和高度未知。" class="headerlink" title="#2.元素的宽度和高度未知。"></a>#2.元素的宽度和高度未知。</h3><p> 如果元素的高度和宽度未知，那么可以利用transform属性来实现。</p>
<p>HTML:<br>        <main></main></p>
<pre><code>  &lt;div&gt;
     I&apos;m a block-level element of an unknown height and width, centered vertically within my parent.
  &lt;/div&gt;

&lt;/main&gt;
</code></pre><p>CSS:<br>        body {<br>          background: #f06d06;<br>          font-size: 80%;<br>          padding: 20px;<br>        }</p>
<pre><code>main {
  position: relative;
  background: white;
  height: 200px;
  width: 60%;
  margin: 0 auto;
  padding: 20px;
  resize: both;
  overflow: auto;
}

main div {
  background: black;
  color: white;
  width: 50%;
  transform: translate(-50%, -50%);
  position: absolute;
  top: 50%;
  left: 50%;
  padding: 20px;
  resize: both;
  overflow: auto;
}
</code></pre><h3 id="3-是否可以使用flex-box-1"><a href="#3-是否可以使用flex-box-1" class="headerlink" title="# 3.是否可以使用flex-box"></a># 3.是否可以使用flex-box</h3><p>HTML:<br>        <main></main></p>
<pre><code>  &lt;div&gt;
     I&apos;m a block-level-ish element of an unknown width and height, centered vertically within my parent.
  &lt;/div&gt;

&lt;/main&gt;
</code></pre><p>CSS:<br>        body {<br>          background: #f06d06;<br>          font-size: 80%;<br>          padding: 20px;<br>        }</p>
<pre><code>main {
  background: white;
  height: 200px;
  width: 60%;
  margin: 0 auto;
  padding: 20px;
  display: flex;
  justify-content: center;
  align-items: center;
  resize: both;
  overflow: auto;
}

main div {
  background: black;
  color: white;
  width: 50%;
  padding: 20px;
  resize: both;
  overflow: auto;
}
</code></pre><p>参考资料：</p>
<ul>
<li><a href="https://css-tricks.com/centering-css-complete-guide/" title="Centering CSS Complete Guide" target="_blank" rel="noopener">https://css-tricks.com/centering-css-complete-guide/</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jack-nie.github.io/centering-css-complete-guide/" data-id="cjqvrwirc0004ud6x53hm8vw7" class="article-share-link">Share</a>
      
        <a href="http://jack-nie.github.io/centering-css-complete-guide/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/">CSS</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-explain-build_stubbed" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/explain-build_stubbed/" class="article-date">
  <time datetime="2015-02-19T16:00:00.000Z" itemprop="datePublished">2015-02-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Test/">Test</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/explain-build_stubbed/">【翻译】build_stubbed详解--Factory Girl</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>build_stubbed是在FactoryGirl中引入的一个方法，build_stubbed和build都是用来创建实例并分配属性。区别是build_stubbed使得对象看起来像是被持久化了，实际上并没有。它采用build_stubbed策略来创建关联，并且提供了少量的同数据库进行交互的方法，如果调用他们，这些方法会被触发。通过这种策略，可以加快测试的速度，同时减少对数据库的依赖。</p>
<p>但是如果创建的对象有关联的对象的话，被关联的对象是会被持久化到数据中的。为了避免这一情况的<br>发生可以将不必要的的关联设置为nil。<br>    Ruby Code:<br>    assoiation :store<br>    assoiation :area</p>
<pre><code>FactoryGirl.build_stubbed(:store, company: fg_company, area: nil)
</code></pre><p>通过这种方式就不会额外的创建被关联的数据了。如果创建时有很多依赖，但是你忘记了将其中的一个<br>或者几个关联设置为nil，同样会往数据库中写入很多数据。这里给出解决方案：</p>
<ol>
<li>在FactoryGirl的定义中手动的删除assoiation。</li>
<li><p>将所有的实例变量移入before(:all)代码块中。<br> Ruby Code:<br> before(:all) do<br>   @company = FactoryGirl.build_stubbed(:company)<br>   @store = FactoryGirl.build_stubbed(:store, company: company)<br> end<br>或者采用下面的方案：<br> Ruby Code:<br> factory :post do<br>   title # sequence<br>   author # sequence, so the example is shorter</p>
<h1 id="stuff"><a href="#stuff" class="headerlink" title="stuff"></a>stuff</h1><p>   after(:build) {|p| p.comments ||= create_list(:comment, 5, post: p) }<br>   after(:stub) {|p| p.comments ||= build_stubbed_list(:comment, 5, post: p}<br> end</p>
<p> create(:post) # with auto comments<br> create(:post, comments: some_other_comments) # with comments for a specific test<br> build_stubbed(:post) # with auto comments and no DB<br> build_stubbed(:post, comments: []) # a post with no comments, still not touching the DB<br>这种用法使得before(:all)仅仅被用作提供事物功能的一个骨架。这就导致了测试状态更加的依赖测试的顺序，这是应该避免的。当然，也可以通过在before/after :all 代码块中加入清除数据的逻辑来解决。</p>
</li>
</ol>
<p>参考资料：</p>
<ul>
<li><a href="http://blog.spoolz.com/2012/07/09/small-revelation-factorygirl-build_stubbed-associations-and-let/" title="small-revelation-factorygirl-build_stubbed-associations-and-let" target="_blank" rel="noopener">http://blog.spoolz.com/2012/07/09/small-revelation-factorygirl-build_stubbed-associations-and-let/</a></li>
<li><a href="https://robots.thoughtbot.com/use-factory-girls-build-stubbed-for-a-faster-test" title="use-factory-girls-build-stubbed-for-a-faster-test" target="_blank" rel="noopener">https://robots.thoughtbot.com/use-factory-girls-build-stubbed-for-a-faster-test</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jack-nie.github.io/explain-build_stubbed/" data-id="cjqvrwir20000ud6xfbenlbod" class="article-share-link">Share</a>
      
        <a href="http://jack-nie.github.io/explain-build_stubbed/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Rails/">Rails</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Rspec/">Rspec</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/测试/">测试</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/5/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CSS/">CSS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/DDD/">DDD</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Go/">Go</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTTP/">HTTP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Learning-C/">Learning C</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Rails/">Rails</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/">Ruby</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Server/">Server</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/">TCP/IP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Test/">Test</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/best-practices/">best-practices</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/design-pattern/">design-pattern</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/postgresql/">postgresql</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/weixin/">weixin</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/分布式/">分布式</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DDD/">DDD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Go/">Go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/">HTTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rails/">Rails</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rspec/">Rspec</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ruby/">Ruby</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Server/">Server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP-IP/">TCP/IP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/postgresql/">postgresql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/weixin/">weixin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式/">分布式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/测试/">测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/C/" style="font-size: 12.86px;">C</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/DDD/" style="font-size: 10px;">DDD</a> <a href="/tags/Git/" style="font-size: 11.43px;">Git</a> <a href="/tags/Go/" style="font-size: 18.57px;">Go</a> <a href="/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/tags/JavaScript/" style="font-size: 17.14px;">JavaScript</a> <a href="/tags/Rails/" style="font-size: 14.29px;">Rails</a> <a href="/tags/Rspec/" style="font-size: 10px;">Rspec</a> <a href="/tags/Ruby/" style="font-size: 20px;">Ruby</a> <a href="/tags/Server/" style="font-size: 10px;">Server</a> <a href="/tags/TCP-IP/" style="font-size: 10px;">TCP/IP</a> <a href="/tags/postgresql/" style="font-size: 12.86px;">postgresql</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/weixin/" style="font-size: 11.43px;">weixin</a> <a href="/tags/分布式/" style="font-size: 10px;">分布式</a> <a href="/tags/测试/" style="font-size: 10px;">测试</a> <a href="/tags/设计模式/" style="font-size: 15.71px;">设计模式</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">February 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/gokit-learning-one/">go-kit学习笔记(一)</a>
          </li>
        
          <li>
            <a href="/gokit-introduction/">go-kit简介</a>
          </li>
        
          <li>
            <a href="/golang-context/">golang中context包详解</a>
          </li>
        
          <li>
            <a href="/golang-handle-and-handlefunc/">Golang中的Handle和HandleFunc</a>
          </li>
        
          <li>
            <a href="/golang-http-router/">Golang中的router</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 Jack Nie<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'kingguy';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>